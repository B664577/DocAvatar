# 自动文件监控处理系统

## 功能概述

系统已升级为**全自动文件监控处理系统**，具有以下特点：

### 🔄 自动监控
- **无需手动点击**：系统启动后自动开始监控指定文件夹
- **实时检测**：每5秒自动扫描文件夹，检测新增文件
- **智能排序**：按文件名自动排序处理
- **无缝衔接**：处理完一批文件后自动等待新文件

### 📁 支持文件类型
- 所有图片格式（JPG、PNG、GIF、BMP等）
- PDF文档

### 🤖 自动处理流程
1. **视觉识别**：使用AI模型自动识别图片/PDF内容
2. **思维导图生成**：将识别内容自动转换为结构化思维导图
3. **结果保存**：自动生成合并的思维导图文件

## 使用方法

### 1. 启动监控
- 打开网页后，系统会自动弹出文件夹选择对话框
- 选择要监控的文件夹即可开始自动处理

### 2. 添加新文件
- 无需任何操作，只需将新文件放入监控文件夹
- 系统会自动检测并处理新文件
- 处理状态会实时显示在界面上

### 3. 查看结果
- 每处理完一个文件，结果会自动显示
- 所有结果会自动合并保存为一个文件
- 文件保存在下载文件夹中

### 文件处理流程
1. **首次选择文件夹**：用户点击"动态监控文件夹"按钮，选择需要监控的文件夹
2. **自动扫描**：系统立即扫描文件夹中的所有图片和PDF文件
3. **自动处理**：扫描完成后立即开始自动处理所有文件
4. **持续监控**：每5秒检查一次新文件
5. **新文件处理**：发现新文件后自动加入队列并继续处理
6. **完成通知**：所有文件处理完成后显示状态

### 合并结果下载
- **智能下载**：只在**所有文件真正处理完成后**才自动下载合并的Markdown文件
- **避免重复**：处理过程中不会重复下载，确保包含所有文件
- **文件名格式**：`{文件夹名}_思维导图合集.md`
- **内容结构**：每个文件的处理结果以二级标题分隔
- **时机控制**：新增文件处理完成后会自动更新合并文件并重新下载

## 界面说明

### 状态显示
- 🔄 **自动监控中**：系统正在等待新文件
- **自动处理中...**：正在处理检测到的文件
- **已完成 X 个文件**：显示处理进度

### 控制按钮
- **暂停**：暂停当前处理（保留队列）
- **停止**：停止监控并清空队列

## 技术特性

### 智能队列管理
- 自动跳过已处理文件
- 新文件自动加入处理队列
- 支持文件重命名检测

### 错误处理
- 单个文件处理失败不影响其他文件
- 自动重试机制
- 详细日志输出

### 性能优化
- 增量处理，只处理新文件
- 内存使用优化
- 后台静默处理

## 注意事项

1. **浏览器要求**：需要使用Chrome 86+或Edge 86+版本
2. **API密钥**：首次使用需要配置视觉模型和思维导图模型的API密钥
3. **文件命名**：建议使用有意义的文件名，便于结果识别
4. **网络连接**：需要稳定的网络连接进行AI处理

## 故障排除

### 如果监控未启动
- 检查浏览器是否支持文件系统访问API
- 确保已授予文件夹访问权限
- 查看浏览器控制台日志

### 如果处理中断
- 刷新页面重新启动监控
- 检查API密钥是否有效
- 确认文件格式是否支持

### 查看日志
- 打开浏览器开发者工具（F12）
- 查看Console标签页的详细日志输出

## 示例工作流程

1. **启动**：打开网页 → 选择文件夹 → 自动开始处理
2. **添加文件**：复制新文件到文件夹 → 系统自动检测 → 自动处理
3. **完成**：所有文件处理完成 → 自动生成合并结果 → 继续监控新文件

系统现在完全自动化，您只需要将文件放入指定文件夹，其余工作由系统自动完成！